/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
[17:24:28] INFO     Training script      train_semantic_image_segmentation.py:15
                    started                                                     
           INFO     Akiset datamodule    train_semantic_image_segmentation.py:26
                    created                                                     
           INFO     Length of            train_semantic_image_segmentation.py:28
                    aki_label_names: 27                                         
           INFO     Akiset_datamodule.cl train_semantic_image_segmentation.py:29
                    asses (valid                                                
                    classes): 25                                                
           INFO     Valid classes are:   train_semantic_image_segmentation.py:32
                    ['terrain',                                                 
                    'vegetation', 'lane                                         
                    marking', 'animal',                                         
                    'bird', 'dynamic',                                          
                    'ground', 'person',                                         
                    'rider', 'pole',                                            
                    'road', 'sidewalk',                                         
                    'sky', 'building',                                          
                    'fence', 'wall',                                            
                    'traffic light',                                            
                    'traffic sign',                                             
                    'bicycle', 'bus',                                           
                    'car', 'ego                                                 
                    vehicle',                                                   
                    'motorcycle', 'other                                        
                    vehicle', 'truck']                                          
           INFO     Loading pretrained weights from Hugging Face _builder.py:196
                    hub (timm/resnet18.a1_in1k)                                 
           INFO     [timm/resnet18.a1_in1k] Safe alternative         _hub.py:184
                    available for 'pytorch_model.bin' (as                       
                    'model.safetensors'). Loading weights using                 
                    safetensors.                                                
           INFO     Missing keys (fc.weight, fc.bias) discovered _builder.py:254
                    while loading pretrained weights. This is                   
                    expected if model is being adapted.                         
           INFO     Segmentation model   train_semantic_image_segmentation.py:35
                    created                                                     
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py:76: Starting from v1.9.0, `tensorboardX` has been removed as a dependency of the `lightning.pytorch` package, due to potential conflicts with other packages in the ML ecosystem. For this reason, `logger=True` will use `CSVLogger` as the default logger, unless the `tensorboard` or `tensorboardX` packages are found. Please `pip install lightning[extra]` or one of them to enable TensorBoard support by default
           INFO     Starting training    train_semantic_image_segmentation.py:39
/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/loops/utilities.py:73: `max_epochs` was not set. Setting it to 1000 epochs. To train without an epoch limit, set `max_epochs=-1`.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name          | Type             | Params | Mode 
-----------------------------------------------------------
0 | encoder       | FeatureListNet   | 11.2 M | train
1 | decoder       | LRASPP           | 6.9 K  | train
2 | train_metrics | MetricCollection | 0      | train
3 | valid_metrics | MetricCollection | 0      | train
4 | test_metrics  | MetricCollection | 0      | train
5 | loss_fn       | CrossEntropyLoss | 0      | train
-----------------------------------------------------------
11.2 M    Trainable params
0         Non-trainable params
11.2 M    Total params
44.734    Total estimated model params size (MB)
108       Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
database params are: {'host': '10.61.10.189', 'dbname': 'akidb', 'user': 'reinig'}
database params are: {'host': '10.61.10.189', 'dbname': 'akidb', 'user': 'reinig'}
database params are: {'host': '10.61.10.189', 'dbname': 'akidb', 'user': 'reinig'}
Traceback (most recent call last):
  File "/home/reinig/development/bachelorarbeit/train_semantic_image_segmentation.py", line 45, in <module>
    main()
  File "/home/reinig/development/bachelorarbeit/train_semantic_image_segmentation.py", line 40, in main
    trainer.fit(segmentation_model, datamodule)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 539, in fit
    call._call_and_handle_interrupt(
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 575, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1024, in _run_stage
    self._run_sanity_check()
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1053, in _run_sanity_check
    val_loop.run()
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 412, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/home/reinig/development/bachelorarbeit/models/semantic_image_segmentation.py", line 125, in validation_step
    loss, logits, labels = self.step(batch)
  File "/home/reinig/development/bachelorarbeit/models/semantic_image_segmentation.py", line 115, in step
    return self.loss_fn(logits, labels), logits, labels
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/torch/nn/modules/loss.py", line 1293, in forward
    return F.cross_entropy(
  File "/home/reinig/development/bachelorarbeit/.venv_ants/lib64/python3.9/site-packages/torch/nn/functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
RuntimeError: input and target batch or spatial sizes don't match: target [32, 886, 1600], input [32, 25, 888, 1600]
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]                                                                   srun: error: ant1: task 0: Exited with exit code 1
